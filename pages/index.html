<!DOCTYPE html>
<html lang="zh_CN">

<head>
    <meta charset="UTF-8">
    <script>if (typeof module === 'object') {
            window.module = module;
            module = undefined;
        }


    </script>
    <!-- normal script imports etc  -->
    <script src="../scripts/jquery-3.3.1.js"></script>
    <!-- Insert this line after script imports -->
    <script>
        if (window.module)
            module = window.module;


        const KIS_NAME = 'KIS系统'
        const KIS_VERSION = 'v1.0'
        let DOCUMENT_TITLE_PREFIX = '';
        let SYS_CONFIG = null;

    </script>


    <!--<link rel="stylesheet" type="text/css" href="./scripts/jquery-easyui/themes/material-teal/easyui.css">-->
    <link rel="stylesheet" type="text/css" href="../scripts/jquery-easyui/themes/ui-cupertino/easyui.css">
    <link rel="stylesheet" type="text/css" href="../scripts/jquery-easyui/themes/icon.css">
    <link rel="stylesheet" type="text/css" href="../scripts/jquery-easyui/themes/color.css">
    <link rel="stylesheet" type="text/css" href="../styles/kis.css">

    <script type="text/javascript" src="../scripts/db.js"></script>


    <script type="text/javascript" src="../scripts/jquery-easyui/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="../scripts/jquery-easyui/locale/easyui-lang-zh_CN.js"></script>



    <script type="text/javascript" src="../scripts/kis.js"></script>
    <script type="text/javascript" src="../scripts/user.js"></script>
    <script type="text/javascript" src="../scripts/customer.js"></script>
    <script type="text/javascript" src="../scripts/product.js"></script>
    <script type="text/javascript" src="../scripts/classification.js"></script>
    <script type="text/javascript" src="../scripts/cartype.js"></script>
    <script type="text/javascript" src="../scripts/utils.js"></script>
    <script type="text/javascript" src="../scripts/loading.js"></script>
    <script type="text/javascript" src="../scripts/order.js"></script>


    <script type="text/javascript" src="../scripts/jquery-easyui/plugins/datagrid-export/datagrid-export.js"></script>
    <script type="text/javascript" src="../scripts/jquery-easyui/plugins/datagrid-filter/datagrid-filter.js"></script>
    <script type="text/javascript" src="../scripts/jquery-easyui/plugins/datagrid-detailview.js"></script>
    <script type="text/javascript" src="../scripts/jquery-easyui/plugins/datagrid-groupview.js"></script>

    <script>
        $.extend($.fn.textbox.methods, {
            addClearBtn: function (jq, iconCls) {
                return jq.each(
                    function () {
                        var t = $(this);
                        //console.log("t======" + JSON.stringify(t))
                        var opts = t.textbox('options');
                        opts.icons = []//opts.icons || [];  fixed
                        opts.icons.unshift({
                            iconCls: iconCls,
                            handler: function (e) {
                                // console.log("Before clear:" + $(e.data.target).textbox('getText') + "-" + $(e.data.target).textbox('getValue'))
                                $(e.data.target).textbox('clear').textbox('setText', '')//.textbox('textbox').focus();
                                $(this).css('visibility', 'hidden');
                                // console.log("After clear:" + $(e.data.target).textbox('getText') + "-" + $(e.data.target).textbox('getValue'))

                                if (customer_choose_dlg_type == 'list_products') {
                                    loadProducts()
                                } else if (customer_choose_dlg_type == 'new_order') {
                                    resetOrder()
                                }
                            }
                        });
                        t.textbox();
                        if (!t.textbox('getText')) {
                            t.textbox('getIcon', 0).css('visibility', 'hidden');
                        }
                        t.textbox('textbox').bind('keyup', function () {
                            var icon = t.textbox('getIcon', 0);
                            if ($(this).val()) {
                                icon.css('visibility', 'visible');
                            } else {
                                icon.css('visibility', 'hidden');
                            }
                        });
                    }
                );
            }
        });
    </script>
</head>

<body class="easyui-layout" id="main_layout" data-options="border:false" style=" padding:0; margin:0;overflow-y: hidden;overflow-x: hidden; height:100%">

    <div data-options="region:'north',split:false, border:false" style="height:106px;width:100%; -webkit-user-select: none;  margin:0; padding:0;overflow-y: hidden;overflow-x: hidden">

        <div id="title_bar">
            <div style="height:20px; width:20px; margin:3px 2px 0px 5px; line-height: 20px; float:left; background-color:#fff;">
                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px"
                    width="18px" height="18px" y="0px" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000"
                    xml:space="preserve">
                    <g>
                        <path fill="#1f637b" d="M418,496.3c0-17.3-15.2-31.3-34-31.3H232.3c-18.8,0-34,14.1-34,31.3c0,17.3,15.2,31.3,34,31.3H384C402.8,527.6,418,513.5,418,496.3z M135.3,857.2c-25.8,0-46.8-21.3-46.8-47.5V182.7c0-26.2,20.9-47.4,46.8-47.4h502.8c25.8,0,46.8,21.3,46.8,47.4v219.4c27.3,0,53.2,4.6,78.5,11.1V103.8c0-25.9-21.2-47-47.5-47H57.5c-26.2,0-47.5,21.1-47.5,47v784.9c0,25.9,21.3,47,47.5,47h403.6c-22.4-22.8-40.4-49.7-55.1-78.5L135.3,857.2L135.3,857.2z M632.6,626l-47.9,47.8l86.9,86.6l-1,1l47.8,47.8l1-1l1,1l47.9-47.8l-1-1L990,538.3l-47.9-47.8L719.5,712.6L632.6,626z M353,621.8H231.9c-18.6,0-33.6,14.1-33.6,31.3c0,17.4,15,31.4,33.6,31.4H353c18.6,0,33.6-14.1,33.6-31.4C386.6,635.8,371.6,621.8,353,621.8z M865,731.8c-12.4,80.1-81.2,141.5-164.9,141.5c-92.6,0-167.6-74.9-167.6-167.2c0-92.3,75-167.2,167.6-167.2c35.3,0,67.9,11,94.9,29.6l49.5-49.4c-40.1-30.9-89.8-50.1-144.5-50.1C568.8,468.9,462.4,575,462.4,706c0,130.9,106.4,237.1,237.7,237.1c131.3,0,237.7-106.2,237.7-237.1c0-14.6-1.8-28.7-4.3-42.6L865,731.8z M590.6,323.7c0-17.3-15-31.4-33.8-31.4H232.2c-18.7,0-33.8,14.1-33.8,31.4s15.1,31.3,33.8,31.3h324.7C575.6,355,590.6,340.9,590.6,323.7z" />
                    </g>
                </svg>
            </div>
            <div id="main_title" style="height:24px; line-height:24px; margin:0 0 0 2px; padding:0;  float:left; display: inline-block; ">
                <!-- 苏州元斌塑胶科技有限公司
                KIS系统 v1.0 -->
            </div>

            <table class="win_btn_tb">

                <tr>
                    <td>
                        <a class="win_btn" onclick="minwin()">
                            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                x="0px" y="0px" width="10px" height="10px" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000"
                                xml:space="preserve">
                                <g>
                                    <!-- <path d="M10,475.5h980v49H10V475.5z" /> -->
                                    <path d="M990,549.5c0,6.5-5.3,11.8-11.8,11.8H21.8c-6.5,0-11.8-5.3-11.8-11.8v-99c0-6.5,5.3-11.8,11.8-11.8h956.5c6.5,0,11.8,5.3,11.8,11.8V549.5z" />
                                </g>
                            </svg>
                        </a>

                    <td>
                        <a id="to_max_a" class="win_btn" onclick="maxwin()">
                            <!-- <img id="to_max_img" src="../images/to_max_SFont.CN.svg" style="border:0px solid red; width:10px; height:10px" /> -->
                            <svg id="to_unmax" style="display:none;" version="1.1" xmlns="http://www.w3.org/2000/svg"
                                xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="10px" height="10px"
                                viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000" xml:space="preserve">
                                <g>
                                    <path d="M930.6,705.1H754.3v168v59.4v1.1h-59.4v-1.1H69.4v1.1H10v-1.1v-59.4V353.6v-59.4h59.4h168.4V66.4h4.1h55.3h633.4h55.6h3.8v579.3v59.4H930.6z M69.4,873.1h625.5v-168v-59.4V353.6H69.4V873.1z M930.6,125.8H297.2v168.4h397.7h59.4v59.4v292.1h176.3V125.8z" />
                                </g>
                            </svg>

                            <svg id="to_max" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                x="0px" y="0px" width="10px" height="10px" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000"
                                xml:space="preserve">
                                <g>
                                    <g>
                                        <path d="M10,10v980h980V10H10z M934,934H66V66h868V934z" />
                                    </g>
                                </g>
                            </svg>
                        </a>
                    </td>
                    <td>
                        <a class="win_btn" href="#" id="close_btn" onclick="closewin()">
                            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                x="0px" y="0px" width="10px" height="10px" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000"
                                xml:space="preserve">
                                <g>
                                    <path d="M990,69.8L930.2,10L500,440.2L69.8,10L10,69.8L438.5,500L10,930.2L69.8,990L500,559.8L930.2,990l59.8-59.8L561.5,500L990,69.8z" />
                                    <!-- <path d="M990,54.1l-43.3-43.4L500,456.7L53.3,10.7L10,54.1l446.6,446L10,946l43.3,43.3l446.7-446l446.7,446L990,946L543.4,500L990,54.1z" /> -->
                                </g>
                            </svg>
                        </a>
                    </td>
                </tr>
            </table>
        </div>


        <div id="tt" class="easyui-tabs" data-options="border:false, tabWidth:120, tabHeight:26, height:86, plain:true,tools:'#tab-tools'"
            style="width:100%;  margin:0;">

            <div title="出货单管理" data-options="border:false" style="background:-webkit-gradient(linear, 0 0, 0 bottom, from(#ffffff), to(#eaedf1));
	padding:6px;  -webkit-user-select: none; ">
                <div style="float:left; width:60%; padding:0px;">
                    <a class="easyui-linkbutton tool_button" style="-webkit-user-select: none;" onclick="show_panel(this, 'order_input_panel')"
                        data-options="plain:true, iconCls:'icon-large-neworder', size:'large', iconAlign:'left'">单据填开</a>
                    <a id="order_list_menu" class="easyui-linkbutton tool_button" style="-webkit-user-select: none;"
                        onclick="show_panel(this, 'orders_grid_panel')" data-options="plain:true, iconCls:'icon-large-orderlist', size:'large', iconAlign:'left'">单据查询</a>
                    <a class="easyui-linkbutton tool_button" style="-webkit-user-select: none;" onclick="show_panel(this, 'order_report_panel')"
                        data-options="plain:true, iconCls:'icon-large-orderreport', size:'large', iconAlign:'left'">统计报表</a>
                </div>
            </div>

            <div title="资料管理" data-options="closable:false" style="background:-webkit-gradient(linear, 0 0, 0 bottom, from(#ffffff), to(#eaedf1));
	padding:6px;">
                <div style="float:left; width:60%; padding:0px;">
                    <a class="easyui-linkbutton tool_button" onclick="show_panel(this, 'customer_manage_panel')"
                        data-options="plain:true, iconCls:'icon-large-customerconfig', size:'large', iconAlign:'left'">客户管理</a>

                    <a class="easyui-linkbutton tool_button" onclick="show_panel(this, 'product_manage_panel')"
                        data-options="plain:true, iconCls:'icon-large-productmanage',size:'large', iconAlign:'left'">产品管理</a>

                    <a class="easyui-linkbutton tool_button" onclick="show_panel(this, 'driver_manage_panel')"
                        data-options="plain:true, iconCls:'icon-large-drivermanage',size:'large',iconAlign:'left'">司机管理</a>
                </div>
            </div>

            <div title="系统设置" data-options="closable:false" style="background:-webkit-gradient(linear, 0 0, 0 bottom, from(#ffffff), to(#eaedf1));
	padding:6px;">
                <a class="easyui-linkbutton tool_button" onclick="show_panel(this, 'user_manage_panel')" data-options="plain:true,  size:'large', iconCls:'icon-large-usermanage', iconAlign:'left'">用户管理</a>
                <a class="easyui-linkbutton tool_button" onclick="show_panel(this, 'sys_config_panel')" data-options="plain:true, size:'large', iconCls:'icon-large-sysconfig', iconAlign:'left'">系统参数</a>
            </div>

            <!-- <div title="我的账户" data-options="closable:false" style="background:-webkit-gradient(linear, 0 0, 0 bottom, from(#ffffff), to(#eaedf1));
	padding:6px;">
                <a class="easyui-linkbutton tool_button" onclick="show_panel(this, 'password_set_panel')" data-options="plain:true, iconCls:'icon-large-passwordmanage', size:'large',iconAlign:'left'">密码设置</a>
                <a class="easyui-linkbutton tool_button" onclick="logout()" data-options="plain:true, size:'large', iconCls:'icon-large-logout', iconAlign:'left'">注销登录</a>
            </div> -->
        </div>

        <div style="width:70px; position: absolute;top:24px; right:0px; border:none; background:transparent; height:84px; line-height:84px;-webkit-app-region: no-drag;">
            <a class="account_logo"></a>
        </div>
        <!--
    <div id="tab-tools" style="background-color:transparent; border-left:none; border-top:none; border-right:none; -webkit-app-region: no-drag">
        <a class="menu_a" style="margin-right:10px; margin-top:2px; display:block; background-color:transparent; border:none;" onclick="showAccountMenu(e)">
            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="20px" height="20px" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000" xml:space="preserve">
<g><path fill="blue" d="M850,45H150C72.6,45,10,107.7,10,185v630c0,77.3,62.6,140,140,140h700c77.3,0,140-62.7,140-140V185C990,107.7,927.3,45,850,45z M920,815c0,38.6-31.4,70-70,70H150c-38.6,0-70-31.4-70-70V185c0-38.6,31.4-70,70-70h700c38.6,0,70,31.4,70,70V815z"/><path d="M220,257.9h70v70h-70V257.9z"/><path d="M360,255h420v70H360V255z"/><path d="M220,467.9h70v70h-70V467.9z"/><path d="M360,465h420v70H360V465z"/><path d="M220,677.9h70v70h-70V677.9z"/><path d="M360,675h420v70H360V675z"/></g>
</svg></a>
    </div>-->

    </div>


    <div data-options="region:'center', border:false" style="margin:0;padding:0px;background:#eee;overflow-y: hidden;overflow-x: hidden; -webkit-app-region: no-drag">

        <!--新开送货单-->
        <div id="order_input_panel" class="easyui-panel opt_panel" 　 style="width:100%; height:100%; padding:0px 0px; background-color:#999; text-align:center; "
            data-options="fit:true,closed:true, border:false, onOpen:resetOrder">

            <div style="padding:0px 0px; border:0px solid red; width:850px;  margin:10px auto;  text-align:right;">
                <div id="order_input_toolbar" style=" height:40px; line-height:40px; margin:0px auto 1px; background-color:#eee; padding:0px 10px; border:0px solid #bbb;  float:right;">
                    <span>
                        <a class="easyui-linkbutton" onclick="resetOrder()" data-options="plain:true,iconCls:'icon-undo',iconAlign:'left'">重填</a>

                        <a class="easyui-linkbutton" onclick="addOrderRow()" data-options="plain:true,iconCls:'icon-add',iconAlign:'left'">增行</a>

                        <a class="easyui-linkbutton" onclick="deleteOrderRow()" data-options="plain:true,iconCls:'icon-remove',iconAlign:'left'">减行</a>

                        <a class="easyui-linkbutton" onclick="doPrint()" data-options="plain:true,iconCls:'icon-print',iconAlign:'left'">打印</a>
                    </span>
                    <div style="clear:both; height:1px; line-height:1px"></div>
                </div>
            </div>
            <div class="new_order_main_div" style="padding:20px 20px;width:810px;margin:0px auto ; clear:both;">
                <div style="width:100%; padding:0">
                    <form id="new_order_form" style="padding:0">
                        <div style="text-align: center; padding:10px;"><span style="font-size:26px;margin:0 auto;">苏州元斌塑胶科技有限公司
                                出货单</span></div>
                        <table class="bill_customer_table">
                            <tr>
                                <td>客户名称：<input id="new_order_customer_name" data-options="height:30" class="easyui-textbox customer_name" />
                                </td>
                                <td>送货日期：<input id="new_order_sale_date" class="easyui-datebox sale_date" data-options="editable:false, height:30, formatter:myDateFormatter"
                                        value="new Date()" labelPosition="top" />
                                </td>
                                <td>出货单号：<span id="new_order_sale_No" style="font-weight:bold;"></span>
                                    <!--<input type="hidden" id="new_order_sale_No" />-->
                                </td>
                            </tr>
                            <tr>
                                <td>送货地址：<input id="new_order_customer_address" data-options="height:30" class="customer_address easyui-textbox" />
                                </td>
                                <td>联&ensp;系&ensp;人：<input id="new_order_customer_principal" data-options="height:30" class="principal easyui-textbox" />
                                </td>
                                <td>联系电话：<input id="new_order_customer_phone" data-options="height:30" class="telephone easyui-textbox" /></td>
                            </tr>
                        </table>

                        <div id="order_products_grid_wrapper" style="width:808px;  border:1px solid #aaa; margin:10px 0 0; padding:0 ">
                            <table id="order_products_grid" class="easyui-datagrid" 
                            data-options="width:'100%', height:202, data:[], border:false, autoRowHeight:false,
                            rowStyler: function(index,row){
                                    return 'height:30px';
                    	
                            },
                           singleSelect:true, onLoadSuccess:onLoadSuccess, onClickCell: onClickCell">
                                <thead>
                                    <tr>
                                        <th data-options="field:'product_name', align:'left', halign:'center',width:248,editor:{
                            type:'textbox',
                            options:{
                                prompt: '',
                                editable: false,
                                cls:'product_choose_textbox',
                                iconWidth: 22,
                                icons: [{
                                    iconCls:'icon-select',
                                    handler: function(e){
                                        $('#dlg_for_product_choose').dialog('open').dialog('center');
                                    }
                                }]
                            }
                        }">品名规格
                                        </th>
                                        <th data-options="field:'product_units', align:'center', halign:'center', width:80, editor:'textbox'">
                                            单位
                                        </th>
                                        <th data-options="field:'product_num', align:'center', halign:'center', width:100, editor:{type:'textbox', options:{onChange:onChangeNum}}">
                                            数量
                                        </th>
                                        <th data-options="field:'product_price', align:'center', halign:'center', width:80, editor:{type:'numberbox',options:{precision:2, onChange:onChangePrice}}">
                                            单价
                                        </th>
                                        <th data-options="field:'product_sum', align:'center', halign:'center', width:100, editor:{type:'numberbox',options:{precision:2}}">
                                            金额
                                        </th>
                                        <th data-options="field:'product_memo', align:'left', halign:'center', width:200, editor:'textbox'">
                                            备注
                                        </th>
                                    </tr>
                                </thead>
                            </table>


                            <table  style="border-collapse: collapse; width:100%; border:none;" >
                                <tr>
                                    <td style="text-align:right; width:328px; height:30px;  font-weight:bold; border:0px solid red;">合计数量：</td>
                                    <td style="text-align:left; width:110px; height:30px;  font-weight:bold;"><span id="products_num"></span></td>
                                    <td style="text-align:right; width:80px; height:30px;  font-weight:bold; border:0px solid red;">合计金额：</td>
                                    <td style="text-align:left;font-weight:bold;"><span id="products_sum"></span></td>
                                </tr>
                            </table>

                        </div>

                        <table class="bill_user_table">
                                <td>制单人：<input id="new_order_maker" data-options="height:30" class="f1 easyui-textbox"></input></td>
                                <td>送货司机：<select class="easyui-combogrid" id="driver_select" data-options="onShowPanel:onShowDriverPanel,
                                        panelWidth: 810,
                                        height:30,
                                        panelMaxHeight:220,
                                        idField: 'name',
                                        textField: 'name',
                                        data:[],
                                        columns: [[
                                            {field:'name',title:'司机',width:90, align:'left', halign:'center'},
                                            {field:'car_type',title:'货车类型',width:110, align:'left', halign:'center', formatter: function(value,row,index){
                                                             if (row.cartype) return row.cartype.name;} },
                                            {field:'car_No',title:'车牌号',width:90, align:'left', halign:'center'},
                                            {field:'driving_license_No',title:'行驶证号',width:110, align:'left', halign:'center'},
                                            {field:'id_No',title:'身份证号',width:110, align:'left', halign:'center'},
                                            {field:'phone',title:'电话',width:90, align:'left', halign:'center'},
                                            {field:'address',title:'地址',width:200, align:'left', halign:'center'}
                                        ]]"
                                        style="width:150px;"></select>
                                </td>
                                <td>签收人：<input data-options="height:30" class="f1 easyui-textbox" disabled></input></td>
                        </table>
                    </form>
                </div>

            </div>
        </div>

        <!--送货单列表-->
        <div id="orders_grid_panel" class="easyui-panel opt_panel" style="width:100%; height:100%; " data-options="fit:true, closed:true, border:false, onOpen:onOpenOrderListPanel">
            <div class="easyui-layout" data-options="fit:true">
                <div data-options="region:'west'" style="width:280px; padding:4px 8px;">
                    <table style="width:100%; border-collapse: collapse">
                        <tr>
                            <th COLSPAN="2">
                                <h4>查询条件：</h4>
                            </th>
                        </tr>
                        <tr>
                            <td style="padding:10px 0 5px 0;">起始日期:
                            <td style="width:200px;padding:10px 0 5px 0;"><input id="dd_begin" type="text" class="easyui-datebox"
                                    style="width:100%" />
                            </td>
                        </tr>
                        <tr>
                            <td style="padding:5px 0 10px 0;">结束日期:
                            <td style="width:200px;padding:5px 0 10px 0;"><input id="dd_end" type="text" style="width:100%"
                                    class="easyui-datebox" /></td>
                        </tr>
                        <tr>
                            <td style="padding:10px 0;">客户名称:</td>
                            <td style="width:200px;padding:10px 0;">
                                <input id="customer_choose_for_order_list" class="easyui-textbox" data-options="icons: [{
                                    iconCls:'icon-select',
                                    handler: function(e){
                                        open_customer_choose_for_list_order();
                                    }
                                }] "
                                    style="width:100%;">
                            </td>
                        </tr>
                        <tr>
                            <td style="padding:10px 0;">制&ensp;单&ensp;人:</td>
                            <td style="width:200px;padding:10px 0;">
                                <input id="order_maker_searchbox" class="easyui-textbox" style="width:100%" />
                            </td>
                        </tr>
                        <tr>
                            <td style="padding:10px 0;">送货司机:</td>
                            <td style="width:200px;padding:10px 0;">
                                <input id="order_dirver_searchbox" class="easyui-textbox" style="width:100%" />
                            </td>
                        </tr>
                        <tr>
                            <td style="padding:10px 0;">单据状态:</td>
                            <td style="width:200px;padding:10px 0;">
                                <select id="order_state" class="easyui-combobox" data-options="panelHeight:100" style="width:100%;">
                                    <option value="">全部</option>
                                    <option value="false">正常</option>
                                    <option value="true">作废</option>
                                </select>
                            </td>
                        </tr>

                        <tr>
                            <td style=""></td>
                            <td style="text-align: center; padding:15px 0;"><a class="easyui-linkbutton" style="width:100%;"
                                    data-options="iconCls:'icon-search',iconAlign:'left'" onclick="loadOrderGrid()">查询</a></td>
                        </tr>

                    </table>
                </div>
                <div data-options="region:'center'" style="padding:0px;">
                    <table id="order_grid" class="easyui-datagrid " style="width:100%"></table>
                    <div id="order_grid_toolbar" style="padding:2px 5px;">
                        <a href="#" class="easyui-linkbutton" iconCls="icon-add" plain="true" onclick="cancelOrder()">作废</a>
                        <a href="#" class="easyui-linkbutton" iconCls="icon-edit" plain="true" onclick="printPreview()">打印</a>
                        <a href="#" class="easyui-linkbutton" iconCls="icon-save" plain="true" onclick="destroyCustomer()">删除</a>
                        <a href="#" class="easyui-linkbutton" iconCls="icon-cut" plain="true" onclick="exportExcel(ORDER_GRID, '出货单列表.xls')">导出到excel</a>
                        <span style="margin-left:20px" class="search_label">检索：</span>
                        <input type="text" id="order_search_text" class="search_input" onkeyup="onSearch(this, ORDER_GRID, doSearchOrder)">
                    </div>
                </div>
            </div>
        </div>

        <!--客户管理-->
        <div id="customer_manage_panel" class="easyui-panel opt_panel" style="width:100%; height:100%; " data-options="fit:true, closed:true, border:false, onOpen:onOpenCustomerManagePanel">
            <div class="easyui-layout" data-options="fit:true">
                <div data-options="region:'west'" style="width:180px; padding:4px;">
                    <ul id="classification_tree" class="easyui-tree" data-options="lines:true,onSelect:loadCustomerGrid,
                        onContextMenu: function(e,node){
                                            e.preventDefault();
                                            $(this).tree('select',node.target);
                                            $('#mm_classification').menu('show',{
                                                left: e.pageX,
                                                top: e.pageY
                                            });
                                        }">
                    </ul>
                    <div id="mm_classification" class="easyui-menu" style="width:120px;" data-options="">
                        <div onclick="edit_classification_tree_node()" data-options="iconCls:'icon-add'">编辑此编码</div>
                        <div onclick="append_classification_tree_node()" data-options="iconCls:'icon-add'">添加子编码</div>
                        <div onclick="delete_classification_tree_node()" data-options="iconCls:'icon-remove'">删除此编码</div>
                    </div>

                    <div id="dlg_for_classification" class="easyui-dialog" style="width:400px" data-options="closed:true,modal:true,border:'thin',buttons:'#dlg_buttons_for_classification'">
                        <form id="fm_for_classification" method="post" novalidate style="margin:0;padding:20px 50px">
                            <div style="margin-bottom:10px">
                                <input name="text" id="classification_name_textbox" class="easyui-textbox" required="true"
                                    label="编码名称：" labelAlign="right" style="width:100%">
                            </div>
                        </form>
                    </div>
                    <div id="dlg_buttons_for_classification">
                        <a href="javascript:void(0)" class="easyui-linkbutton c6" iconCls="icon-ok" onclick="saveClassification()"
                            style="width:90px">保存</a>
                        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:$('#dlg_for_classification').dialog('close')"
                            style="width:90px">取消</a>
                    </div>
                </div>
                <div data-options="region:'center'" style="padding:0px;">
                    <table id="grid_for_customer" style="width:100%"></table>

                    <div id="customer_grid_toolbar" style="padding:2px 5px;">
                        <a href="#" class="easyui-linkbutton" iconCls="icon-add" plain="true" onclick="newCustomer()">添加</a>
                        <a href="#" class="easyui-linkbutton" iconCls="icon-edit" plain="true" onclick="editCustomer()">编辑</a>
                        <a href="#" class="easyui-linkbutton" iconCls="icon-save" plain="true" onclick="destroyCustomer()">删除</a>
                        <a href="#" class="easyui-linkbutton" iconCls="icon-cut" plain="true" onclick="exportExcel(CUSTOMER_GRID, '客户列表.xls')">导出到excel</a>
                        <span style="margin-left:20px" class="search_label">检索：</span>
                        <input type="text" id="customer_search_text" class="search_input" onkeyup="onSearch(this, CUSTOMER_GRID, doSearchCustomer)">
                    </div>

                    <div id="dlg_for_customer" class="easyui-dialog" style="width:500px" data-options="closed:true,modal:true,border:'thin',buttons:'#dlg_buttons_for_customer'">
                        <form id="fm_for_customer" method="post" novalidate style="margin:0;padding:20px 50px">
                            <div style="margin-bottom:10px">

                                <input name="name" id="customer_name" class="easyui-textbox" required="true" label="客户名称："
                                    labelAlign="right" style="width:100%">
                                <input name="_id" id="customer_id" type="hidden" />
                            </div>
                            <div style="margin-bottom:10px">

                                <input name="index_code" id="customer_index_code" class="easyui-textbox" label="客户简码："
                                    labelAlign="right" style="width:100%">
                            </div>
                            <div style="margin-bottom:10px">

                                <input name="classification" id="customer_classification" class="easyui-combotree"
                                    data-options="data:[], editable:false, required:true, lines:true, onShowPanel:showClassificationCombotree, onBeforeSelect:beforeSelectClassificationCombotree"
                                    label="编码分类：" labelAlign="right" style="width:100%">
                            </div>

                            <div style="margin-bottom:10px">

                                <input id="customer_principal" class="easyui-textbox" name="principal" labelAlign="right"
                                    required="true" label="联&nbsp;&nbsp;系&nbsp;&nbsp;人：" style="width:100%">
                            </div>
                            <div style="margin-bottom:10px">

                                <input id="customer_phone" class="easyui-textbox" name="phone" labelAlign="right"
                                    required="true" label="联系电话：" style="width:100%">
                            </div>
                            <div style="margin-bottom:10px">

                                <input id="customer_address" class="easyui-textbox" name="address" labelAlign="right"
                                    required="true" label="联系地址：" style="width:100%">
                            </div>
                        </form>
                    </div>
                    <div id="dlg_buttons_for_customer">
                        <a href="javascript:void(0)" class="easyui-linkbutton c6" iconCls="icon-ok" onclick="saveCustomer()"
                            style="width:90px">保存</a>
                        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:$('#dlg_for_customer').dialog('close')"
                            style="width:90px">取消</a>
                    </div>
                </div>
            </div>

        </div>

        <!--产品管理-->
        <div id="product_manage_panel" class="easyui-panel opt_panel" 　 style="width:800px; height:100%; padding:0px 0px; text-align:center; "
            data-options="fit:true, closed:true, border:false, onOpen:onOpenProductManagePanel">

            <div class="easyui-layout" data-options="fit:true, border:false">
                <div data-options="region:'west'" style="width:300px; padding:4px;">

                    <div style="color:red; margin-top:10px; width:100%;">
                        说明：未选择客户，则为管理通用产品信息。
                    </div>
                    <input id="customer_choose_for_product_manage" class="easyui-textbox" data-options="buttonText:'选择客户',prompt:'选择客户',onClickButton:open_customer_choose_for_product_manage"
                        style="width:100%;">


                    <div id="selected_customer_info" style="width:100%; height:300px;"></div>

                </div>
                <div data-options="region:'center'" style="padding:0px;">
                    <table id="product_grid" style="width:100%"></table>

                    <div id="dlg_for_product" class="easyui-dialog" style="width:500px" data-options="closed:true,modal:true,border:'thin',buttons:'#dlg-buttons_for_product'">
                        <form id="fm_for_product" method="post" novalidate style="margin:0;padding:20px 50px">
                            <div style="margin-bottom:10px">
                                <input name="name" id="product_name" class="easyui-textbox" required="true" label="品名："
                                    labelAlign="right" style="width:100%">
                                <input name="_id" id="product_id" type="hidden" />
                            </div>
                            <div style="margin-bottom:10px">
                                <input name="model" id="product_model" class="easyui-textbox" required="true" label="型号："
                                    labelAlign="right" style="width:100%">
                            </div>

                            <div style="margin-bottom:10px">
                                <input name="units" id="product_units" class="easyui-textbox" required="true" label="单位："
                                    labelAlign="right" style="width:100%">
                            </div>
                            <div style="margin-bottom:10px">
                                <input name="price" id="product_price" class="easyui-numberbox" data-options="min:0,precision:2"
                                    label="单价：" labelAlign="right" style="width:100%">
                            </div>
                            <div style="margin-bottom:10px">
                                <input id="product_memo" class="easyui-textbox" name="memo" labelAlign="right" label="描述："
                                    style="width:100%">
                            </div>
                        </form>
                    </div>
                    <div id="dlg-buttons_for_product">
                        <a href="javascript:void(0)" class="easyui-linkbutton c6" iconCls="icon-ok" onclick="saveProduct()"
                            style="width:90px">确定</a>
                        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="$('#dlg_for_product').dialog('close')"
                            style="width:90px">取消</a>
                    </div>

                </div>
            </div>
        </div>

        <!--司机管理-->
        <div id="driver_manage_panel" class="easyui-panel opt_panel" data-options="fit:true, closed:true, border:false, onOpen:onOpenDriverManagePanel">
            <div class="easyui-layout" data-options="fit:true, border:false">
                <div data-options="region:'west'" style="width:180px; padding:4px;">
                    <ul id="cartype_tree" class="easyui-tree" data-options="lines:true, onContextMenu: onCarTypeTreeContextMenu,onSelect:loadDriverGrid">
                    </ul>
                    <div id="mm_cartype" class="easyui-menu" style="width:120px;" data-options="">
                        <div id="cartype_menu_edit" onclick="edit_cartype_tree_node()" data-options="iconCls:'icon-add'">
                            编辑
                        </div>
                        <div id="cartype_menu_append" onclick="append_cartype_tree_node()" data-options="iconCls:'icon-add'">添加
                        </div>
                        <div id="cartype_menu_delete" onclick="delete_cartype_tree_node()" data-options="iconCls:'icon-remove'">删除
                        </div>
                    </div>
                    <div id="dlg_for_cartype" class="easyui-dialog" style="width:400px" data-options="closed:true,modal:true,border:'thin',buttons:'#dlg_buttons_for_cartype'">
                        <form id="fm_for_cartype" method="post" novalidate style="margin:0;padding:20px 50px">
                            <div style="margin-bottom:10px">
                                <input name="cartype_name" id="cartype_name_textbox" class="easyui-textbox" required="true"
                                    label="货车分类：" labelAlign="right" style="width:100%">
                                <input id="cartype_id" type="hidden" />
                            </div>
                        </form>
                    </div>
                    <div id="dlg_buttons_for_cartype">
                        <a href="javascript:void(0)" class="easyui-linkbutton c6" iconCls="icon-ok" onclick="saveCartype()"
                            style="width:90px">保存</a>
                        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:$('#dlg_for_cartype').dialog('close')"
                            style="width:90px">取消</a>
                    </div>

                </div>
                <div data-options="region:'center'" style="padding:0px;">
                    <table id="driver_grid"></table>
                    <div id="dlg_for_driver" class="easyui-dialog" style="width:500px" data-options="closed:true,modal:true,border:'thin',buttons:'#dlg-buttons_for_driver', onOpen:loadCartypeSelectData">
                        <form id="fm_for_driver" method="post" novalidate style="margin:0;padding:20px 50px">
                            <div style="margin-bottom:10px">
                                <input name="name" id="driver_name" class="easyui-textbox" required="true" label="司机名称："
                                    labelAlign="right" style="width:100%">
                                <input name="_id" id="driver_id" type="hidden" />
                            </div>

                            <div style="margin-bottom:10px">
                                <select name="cartype" id="driver_car_type" class="easyui-combobox" required="true"
                                    data-options="data:[], valueField:'_id', textField:'name'" editable="false" label="货车分类："
                                    labelAlign="right" style="width:100%">
                                </select>
                            </div>

                            <div style="margin-bottom:10px">
                                <input name="car_No" id="driver_car_No" class="easyui-textbox" required="true" label="车牌号码："
                                    labelAlign="right" style="width:100%">
                            </div>

                            <div style="margin-bottom:10px">
                                <input name="id_No" id="driver_id_No" class="easyui-textbox" required="true" label="身份证号："
                                    labelAlign="right" style="width:100%">
                            </div>
                            <div style="margin-bottom:10px">
                                <input name="driving_license_No" id="driver_driving_license_No" class="easyui-textbox"
                                    required="true" label="行驶证号：" labelAlign="right" style="width:100%">
                            </div>
                            <div style="margin-bottom:10px">
                                <input id="driver_phone" class="easyui-textbox" name="phone" labelAlign="right" label="联系电话："
                                    style="width:100%">
                            </div>
                            <div style="margin-bottom:10px">
                                <input id="driver_address" class="easyui-textbox" name="address" labelAlign="right"
                                    label="联系地址：" style="width:100%">
                            </div>
                        </form>
                    </div>
                    <div id="dlg-buttons_for_driver">
                        <a href="javascript:void(0)" class="easyui-linkbutton c6" iconCls="icon-ok" onclick="saveDriver()"
                            style="width:90px">确定</a>
                        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:$('#dlg_for_driver').dialog('close')"
                            style="width:90px">取消</a>
                    </div>
                </div>
            </div>
        </div>

        <!--登录用户管理-->
        <div id="user_manage_panel" class="easyui-panel opt_panel" data-options="fit:true, border:false, closed:true, onOpen:onOpenUserManagePanel">
            <div class="easyui-layout" data-options="fit:true, border:false">
                <div data-options="region:'west'" style="width:180px; padding:4px;">
                    <ul id="role_tree" class="easyui-tree" data-options="lines:true,onSelect:loadSysUsers">
                    </ul>
                </div>
                <div data-options="region:'center'" style="padding:0px;">
                    <table id="sys_user_datagrid"></table>
                    <div id="dlg" class="easyui-dialog" style="width:400px" data-options="closed:true,modal:true,border:'thin',buttons:'#dlg-buttons'">
                        <form id="fm" method="post" novalidate style="margin:0;padding:20px 50px">
                            <div style="margin-bottom:10px">
                                <input name="name" id="name_textbox" class="easyui-textbox" required="true" label="用户名："
                                    labelAlign="right" style="width:100%">
                                <input name="_id" id="user_id" type="hidden" />
                            </div>
                            <div style="margin-bottom:10px">
                                <input name="role" id="role_combobox" class="easyui-combobox" required="true"
                                    data-options="panelHeight:40" label="角&emsp;色：" labelAlign="right" style="width:100%">
                            </div>
                            <div style="margin-bottom:10px">

                                <input id="disabled_checkbox" class="easyui-checkbox" name="disabled" labelAlign="right"
                                    label="禁&emsp;用：">

                            </div>
                        </form>
                    </div>
                    <div id="dlg-buttons">
                        <a href="javascript:void(0)" class="easyui-linkbutton c6" iconCls="icon-ok" onclick="saveUser()"
                            style="width:90px">确定</a>
                        <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:$('#dlg').dialog('close')"
                            style="width:90px">取消</a>
                    </div>
                </div>
            </div>
        </div>


        <!--系统设置-->
        <div id="sys_config_panel" class="easyui-panel opt_panel" data-options="fit:true, closed:true, border:true, onOpen:onOpenSysConfigPanel">
            <div class="easyui-panel" data-options="title:'系统设置', width:600, style:{marginLeft:'auto', marginRight:'auto', marginTop:20}">
                <form id="fm_for_system" method="post" novalidate style="margin:0;padding:20px 50px">
                    <div style="margin-top:20px">
                        <input id="company_name" class="easyui-textbox" required="true" label="公司名称：" labelAlign="right"
                            style="width:100%">
                    </div>
                    <div style="margin-top:20px">
                        <input id="company_phone" class="easyui-textbox" label="公司电话：" labelAlign="right" style="width:100%">
                    </div>

                    <div style="margin-top:20px">
                        <input id="company_fax" class="easyui-textbox" label="公司传真：" labelAlign="right" style="width:100%">
                    </div>
                    <div style="margin-top:20px">
                        <input id="company_address" class="easyui-textbox" label="公司地址：" labelAlign="right" style="width:100%">
                    </div>
                    <div style="margin-top:20px">
                        <input id="company_logo" class="easyui-textbox" labelAlign="right" label="公司logo：" style="width:100%">
                    </div>
                    <div style="margin-top:40px;">
                        <a onclick="set_company()" class="easyui-linkbutton" style="width:100px">确定</a>
                    </div>
                </form>
            </div>

        </div>

        <!--用户设置密码 -->
        <div id="dlg_for_setpassword" class="easyui-dialog" style="width:500px" data-options="title:'修改用户密码', closed:true, modal:true, border:'thin', buttons:'#dlg-buttons_for_setpassword', onOpen:function(){$('#fm_for_setpassword').form('clear')}">
            <form id="fm_for_setpassword" method="post" novalidate style="margin:0;padding:20px 50px">
                <div style="margin-top:20px">
                    <input id="old_pass" class="easyui-passwordbox" label="旧&emsp;密&emsp;码:" labelAlign="left" style="width:100%">
                </div>
                <div style="margin-top:20px">
                    <input id="new_pass" class="easyui-passwordbox" label="新&emsp;密&emsp;码:" labelAlign="left" style="width:100%">
                </div>
                <div style="margin-top:20px">
                    <input id="new_pass_again" class="easyui-passwordbox" label="重复新密码:" labelAlign="left" style="width:100%">
                </div>
            </form>
            <div id="dlg-buttons_for_setpassword">
                <a href="javascript:void(0)" class="easyui-linkbutton c6" iconCls="icon-ok" onclick="set_password()"
                    style="width:90px">确定</a>
                <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="$('#dlg_for_setpassword').dialog('close')"
                    style="width:90px">取消</a>
            </div>
        </div>


        <!-- 客户选择对话框 -->
        <div id="dlg_for_customer_choose" title="选择客户" class="easyui-dialog" style="width:900px; height:550px;"
            data-options="onOpen:onOpenCustomerChooseDlg, resizable:true, closed:true, modal:true, border:'thin', buttons:'#dlg_buttons_for_classification01'">
            <div class="easyui-layout" data-options="fit:true">
                <div data-options="region:'west'" style="width:180px; padding:4px;">
                    <ul id="classification_tree01" class="easyui-tree" data-options="lines:true,onSelect:loadCustomerGrid01,
                      ">
                    </ul>
                </div>
                <div data-options="region:'center'" style="padding:0px;">
                    <table id="grid_for_customer01" style="width:100%">
                    </table>
                    <div id="customer_grid_toolbar01" style="padding:2px 5px;">
                        <span class="search_label">检索：</span>
                        <input class="search_input" type="text" id="customer_search_text01" onkeyup="onSearch(this, CUSTOMER_GRID01, doSearchCustomer)" />
                    </div>
                </div>
            </div>
            <div id="dlg_buttons_for_classification01">
                <a href="javascript:void(0)" class="easyui-linkbutton c6" iconCls="icon-ok" onclick="chooseCustomer()"
                    style="width:90px">确定选择</a>
                <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:$('#dlg_for_customer_choose').dialog('close')"
                    style="width:90px">取消</a>
            </div>
        </div>


        <!-- 产品选择对话框 -->
        <div id="dlg_for_product_choose" title="选择产品" class="easyui-dialog" style="width:700px; height:500px;"
            data-options="onBeforeOpen:onOpenProductChooseDlg, resizable:true, closed:true, modal:true, border:'thin', buttons:'#dlg_buttons_for_product_choose01'">
            <table id="grid_for_product01" style="width:100%">
            </table>
            <div id="dlg_buttons_for_product_choose01">
                    <a href="javascript:void(0)" class="easyui-linkbutton c6" iconCls="icon-ok" onclick="chooseProduct()" style="width:90px">确定选择</a>
                    <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:$('#dlg_for_product_choose').dialog('close')"
                        style="width:90px">取消</a>
            </div>
        </div>
        

        <div id="win" class="easyui-window" title="" style="background-color: #95B8E7" data-options="modal:true, closed:true, height:50, width:200, border:false,  style:{textAlign:'center'}">
            <span style="height:50px;  line-height:50px; margin:0 auto; " id="win_in"></span>
        </div>

        <!--<div id="account_info" >-->
        <div id="account_info" class="easyui-menu" data-options="hideOnUnhover:false,onClick:menuHandler" style="width:120px;">
            <div name="account_info">账号信息</div>
            <div name="set_password">密码修改</div>
            <div name="logout">注销登录</div>
            <div class="menu-sep"></div>

            <div name="exit">退出系统</div>
            <div class="menu-sep"></div>

            <div>检查更新</div>
            <div name="about">关于</div>
        </div>

        <script>
            const { BrowserWindow } = require('electron').remote
            const { ipcRenderer } = require('electron')
            const win = require('electron').remote.getCurrentWindow();

            function onCarTypeTreeContextMenu(e, node) {
                e.preventDefault();
                $(this).tree('select', node.target);
                let root = $(this).tree('getRoot')
                $('#mm_cartype').menu('show', {
                    left: e.pageX,
                    top: e.pageY
                });

                var cartype_item_edit = $('#cartype_menu_edit')[0];
                var cartype_item_append = $('#cartype_menu_append')[0];
                var cartype_item_delete = $('#cartype_menu_delete')[0];

                if (root == node) {
                    $('#mm_cartype').menu('enableItem', cartype_item_append)
                    $('#mm_cartype').menu('disableItem', cartype_item_edit)
                    $('#mm_cartype').menu('disableItem', cartype_item_delete)
                } else {
                    $('#mm_cartype').menu('disableItem', cartype_item_append)
                    $('#mm_cartype').menu('enableItem', cartype_item_edit)
                    $('#mm_cartype').menu('enableItem', cartype_item_delete)
                }

            }


            function menuHandler(item) {
                switch (item.name) {
                    case 'account_info':
                        alert(localStorage.getItem('user'))
                        break;
                    case 'logout':
                        logout();
                        break;
                    case 'about':
                        // show about
                        let win_about = new BrowserWindow({
                            width: 400,
                            height: 300,
                            modal: true,
                            show: false,
                            maximizable: false,
                            minimizable: false,
                            resizable: false,
                            parent: win,
                            title: '关于系统',
                            autoHideMenuBar: true
                        })
                        win_about.loadURL('file://' + __dirname + '/about.html')
                        win_about.on('closed', () => {
                            win_about = null
                        })
                        win_about.once('ready-to-show', () => {
                            win_about.show()
                        })
                        break;
                    case 'exit':
                        //
                        closewin()
                        break;
                    case 'set_password':
                        // 改弹出框'
                        $('#dlg_for_setpassword').dialog('open')
                        //show_panel('密码修改', 'password_set_panel')
                        break;
                    default:
                        ;
                }
            }



            win.on('maximize', function () {
                // $('#to_max').hide();
                // $('#to_unmax').show();
                // console.log('max')
            })

            win.on('unmaximize', function () {
                // $('#to_unmax').hide();
                // $('#to_max').show();
                // console.log('unmax')
            })


            function showMainWindow() {
                //win.show()
                ipcRenderer.sendSync('main-window-ready', null)
            }


            function showAccountMenu(e) {
                e.preventDefault();
                $('#account_info').menu('show', {
                    left: e.pageX,
                    top: 105
                })
            }



            $(function () {
                loadConfig(function (config) {
                    // localStorage只支持String值
                    console.log("load configs")
                    DOCUMENT_TITLE_PREFIX = config.company_name + KIS_NAME + " " + KIS_VERSION
                    $('#main_title').html(DOCUMENT_TITLE_PREFIX)
                    SYS_CONFIG = config;
                })


                $('#new_order_sale_date').datebox().datebox('calendar').calendar({
                    validator: function (date) {
                        var now = new Date();
                        var d1 = new Date(now.getFullYear(), now.getMonth(), now.getDate() - 1);
                        var d2 = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 6);
                        return d1 <= date && date <= d2;
                    }
                });


                $('.account_logo').bind('click', function (e) {
                    showAccountMenu(e)
                });

                $('#customer_choose_for_product_manage').textbox('addClearBtn', 'icon-clear');
                $('#customer_choose_for_product_manage').textbox('textbox').bind('focus', function (e) {
                    open_customer_choose_for_product_manage()
                });
                $('#new_order_customer_name').textbox('addClearBtn', 'icon-clear');
                $('#new_order_customer_name').textbox('textbox').bind('focus', function (e) {
                    open_customer_choose_for_new_order()
                });

                //去掉tab菜单按钮的href，防止鼠标按住拖动出现href属性
                $('.tabs li a').removeAttr('href')

            });


            function open_customer_choose_for_product_manage() {
                customer_choose_dlg_type = 'list_products'
                $('#dlg_for_customer_choose').dialog('open').dialog('center')
            }

            function open_customer_choose_for_new_order() {
                customer_choose_dlg_type = 'new_order'
                $('#dlg_for_customer_choose').dialog('open').dialog('center')
            }

            function open_customer_choose_for_list_order() {
                customer_choose_dlg_type = 'list_order'
                $('#dlg_for_customer_choose').dialog('open').dialog('center')
            }



            function loadConfig(callback) {
                ConfigModel.findOne({}, function (err, doc) {
                    if (doc) {
                        callback(doc)
                    }
                })
            }

            function logout() {
                ipcRenderer.sendSync('logout')
            }


            function printPreview() {
                let row = ORDER_GRID.datagrid('getSelected')
                if (row) {
                    preview(row, 'list')
                }
            }


            function maxwin() {

                if (win.isMaximized()) {

                    $('#to_unmax').hide();
                    $('#to_max').show();
                    console.log('unmax')
                    win.unmaximize()
                    //win.hide()
                    //win.show()
                    // win.setIgnoreMouseEvents(false)
                    // $('#to_max_a').removeClass('win_btn')
                    // $('#to_max_a').addClass('win_btn')

                    //$('#to_max_img').attr('src', '../images/to_max_SFont.CN.svg')
                    //$('').
                } else {

                    $('#to_max').hide();
                    $('#to_unmax').show();
                    console.log('max')
                    win.maximize()
                    //$('#to_max_img').attr('src', '../images/to_unmax_SFont.CN.svg')

                }
            }

            function minwin() {
                win.minimize()
            }

            function closewin() {
                $.messager.confirm('确定', '确定要关闭应用程序吗?', function (r) {
                    if (r) {
                        win.close()
                    }
                });
            }


            function preview(order, type) {
                type = type || 'new_order'
                localStorage.setItem('order', JSON.stringify(order));
                let win_print = new BrowserWindow({
                    width: 800,
                    height: 570,
                    modal: true,
                    show: false,
                    maximizable: false,
                    minimizable: false,
                    resizable: false,
                    parent: win,
                    title: '打印',
                    autoHideMenuBar: true
                })
                win_print.on('closed', () => {
                    win_print = null

                    if (type == 'new_order') {
                        $.messager.confirm('', '是否继续填写出货单?', function (r) {
                            if (r) {
                                resetOrder();
                            } else {
                                $('#order_list_menu').click()
                            }
                        })

                    } else if (type == 'list') {

                    }
                })

                win_print.loadURL('file://' + __dirname + '/print_template.html')
                win_print.show()
            }
        </script>


</body>

</html>